{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
  <h2>My Bookings</h2>

  {% if bookings %}
    <table class="table table-striped mt-3">
      <thead>
        <tr>
          <th>Date</th>
          <th>Time Slot</th>
          <th>Restaurant</th>
          <th>People</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
          <tr id="booking{{ booking.id }}" data-booking-id="{{ booking.id }}">
            <td>{{ booking.booking_date }}</td>
            <td>{{ booking.time_slot }}</td>
            <td>{{ booking.restaurant.name }}</td>
            <td><span id="people{{ booking.id }}">{{ booking.number_of_people }}</span></td>
            <td>
              {% if booking.status == 1 %}
                <span class="badge bg-success">Confirmed</span>
              {% elif booking.status == 2 %}
                <span class="badge bg-danger">Cancelled</span>
              {% elif booking.status == 3 %}
                <span class="badge bg-secondary">Completed</span>
              {% endif %}
            </td>
            <td>
              {% if booking.status == 1 %}
                <button class="btn btn-sm btn-primary btn-edit" data-id="{{ booking.id }}">Edit</button>
                <button class="btn btn-sm btn-danger btn-cancel" data-id="{{ booking.id }}">Cancel</button>
              {% endif %}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6">You have no bookings.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Hidden edit form -->
    <form id="editForm" method="post" style="display:none;">
      {% csrf_token %}
      <div class="mb-2">
        <label for="id_number_of_people">Number of people:</label>
        <select name="number_of_people" id="id_number_of_people" class="form-select">
          {% for i in "123456" %}
            <option value="{{ i }}">{{ i }}</option>
          {% endfor %}
        </select>
      </div>
      <button type="submit" class="btn btn-primary mt-2">Update</button>
    </form>

  {% else %}
    <p>You donâ€™t have any bookings yet.</p>
  {% endif %}
</div>
{% endblock %}

{% block extras %}
<script src="{% static 'js/bookings.js' %}"></script>
{% endblock %}